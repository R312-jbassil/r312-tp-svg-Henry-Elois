---
import Layout from "../../layouts/Layout.astro";
import pb from "../../../utils/pb";
import { Collections } from "../../../utils/pocketbase-types";

const svgs = await pb.collection(Collections.SvgCollection).getFullList({
  sort: "-created",
});
---

<Layout title="Gallery - SVG Generator">
  <div class="container mx-auto px-4 py-8">
    <h1 class="text-4xl font-bold mb-8">Galerie SVG</h1>

    {
      svgs.length > 0 ? (
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {svgs.map((svg) => (
            <a
              href={`/gallery/${svg.id}`}
              class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow"
            >
              <figure class="bg-gray-100 p-6 min-h-[200px] flex items-center justify-center">
                {svg.code_svg ? (
                  <div
                    set:html={svg.code_svg}
                    class="max-h-[150px] max-w-full overflow-hidden"
                  />
                ) : (
                  <div class="text-gray-400">Aucun SVG</div>
                )}
              </figure>

              <div class="card-body">
                <h2 class="text-lg font-semibold text-gray-800 truncate">
                  {svg.name || `SVG #${svg.id.slice(0, 8)}`}
                </h2>
                <p class="text-sm text-gray-500">
                  Créé le {new Date(svg.created).toLocaleDateString("fr-FR")}
                </p>
              </div>
            </a>
          ))}
        </div>
      ) : (
        <div class="text-center py-20">
          <p class="text-gray-500 mb-4">Aucun SVG dans la galerie</p>
          <a href="/generator" class="btn btn-primary">
            Créer un SVG
          </a>
        </div>
      )
    }
  </div>
</Layout>
